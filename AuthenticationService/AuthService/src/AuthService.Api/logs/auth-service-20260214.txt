[2026-02-14 02:13:26 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 02:13:31 ERR] Ocurrió un error al inicializar la base de datos {"SourceContext":"Program"}
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5436
 ---> System.Net.Sockets.SocketException (10061): No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|214_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabaseCreator.EnsureCreatedAsync(CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Program.cs:line 157
[2026-02-14 02:14:36 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 02:14:38 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 02:14:38 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 02:14:39 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 02:24:49 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBKA2BOMGI:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBKA2BOMGI"}
[2026-02-14 02:24:50 INF] HTTP GET /api/v1/health responded 200 in 824.4023 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBKA2BOMGI:00000001","ConnectionId":"0HNJBKA2BOMGI"}
[2026-02-14 02:41:45 INF] HTTP GET /api/v1/login responded 404 in 135.9138 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBKA2BOMGK:00000001","ConnectionId":"0HNJBKA2BOMGK"}
[2026-02-14 02:43:06 INF] HTTP POST /api/v1/auth/login responded 404 in 123.0419 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBKA2BOMGM:00000001","ConnectionId":"0HNJBKA2BOMGM"}
[2026-02-14 02:50:06 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 02:50:07 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 02:50:07 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 02:50:07 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 02:50:20 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBKOAOV0B1:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBKOAOV0B1"}
[2026-02-14 02:50:20 INF] HTTP GET /api/v1/health responded 200 in 243.0519 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBKOAOV0B1:00000001","ConnectionId":"0HNJBKOAOV0B1"}
[2026-02-14 02:50:26 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBKOAOV0B1:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBKOAOV0B1"}
System.InvalidOperationException: Unable to resolve service for type 'AuthService.Application.Interfaces.IAuthService' while attempting to activate 'AuthService.Api.Controllers.AuthController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method25(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 02:50:26 INF] HTTP POST /api/v1/auth/login responded 400 in 75.3926 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBKOAOV0B1:00000002","ConnectionId":"0HNJBKOAOV0B1"}
[2026-02-14 03:28:11 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 03:28:12 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 03:28:12 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 03:28:13 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 03:29:10 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBLE0RT171:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBLE0RT171"}
[2026-02-14 03:29:10 INF] HTTP GET /api/v1/health responded 200 in 705.4111 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBLE0RT171:00000001","ConnectionId":"0HNJBLE0RT171"}
[2026-02-14 03:29:21 INF] HTTP POST /api/v1/auth/login responded 200 in 3399.7209 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBLE0RT171:00000002","ConnectionId":"0HNJBLE0RT171"}
[2026-02-14 03:32:05 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 03:32:07 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 03:32:07 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 03:32:07 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 03:32:55 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBLG45LR06:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBLG45LR06"}
[2026-02-14 03:32:58 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"6bf1ac0c-f8a1-4ccc-addb-bbdd9e617f41","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBLG45LR06:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBLG45LR06"}
[2026-02-14 03:32:59 INF] HTTP POST /api/v1/auth/login responded 200 in 3446.2441 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBLG45LR06:00000001","ConnectionId":"0HNJBLG45LR06"}
[2026-02-14 10:03:19 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 10:03:20 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 10:03:20 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 10:03:20 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 10:04:27 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBSAT920OK:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBSAT920OK"}
[2026-02-14 10:04:27 INF] HTTP GET /api/v1/health responded 200 in 240.2970 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSAT920OK:00000001","ConnectionId":"0HNJBSAT920OK"}
[2026-02-14 10:18:48 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"b4283877-9c09-4458-9d67-1b0bb2e7293a","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBSAT920OM:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBSAT920OM"}
[2026-02-14 10:18:48 INF] HTTP POST /api/v1/auth/login responded 200 in 1869.9399 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSAT920OM:00000001","ConnectionId":"0HNJBSAT920OM"}
[2026-02-14 10:19:28 ERR] La configuración SMTP no está configurada correctamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"ffd0f031-e6db-4aa0-b3d6-55b790b537e9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSAT920OM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSAT920OM"}
[2026-02-14 10:19:28 ERR] Error al enviar el email {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"ffd0f031-e6db-4aa0-b3d6-55b790b537e9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSAT920OM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSAT920OM"}
System.InvalidOperationException: La configuración SMTP no está configurada correctamente
   at AuthService.Application.Services.EmailService.SendEmailAsync(String to, String subject, String body) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\EmailService.cs:line 117
[2026-02-14 10:19:29 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSAT920OM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSAT920OM"}
System.InvalidOperationException: Error al enviar el email: La configuración SMTP no está configurada correctamente
 ---> System.InvalidOperationException: La configuración SMTP no está configurada correctamente
   at AuthService.Application.Services.EmailService.SendEmailAsync(String to, String subject, String body) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\EmailService.cs:line 117
   --- End of inner exception stack trace ---
   at AuthService.Application.Services.EmailService.SendEmailAsync(String to, String subject, String body) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\EmailService.cs:line 198
   at AuthService.Application.Services.EmailService.SendAdminCreatedUserEmailAsync(String email, String username, String tempPassword, String verificationToken) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\EmailService.cs:line 34
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 145
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method312(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:19:29 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 1302.8530 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSAT920OM:00000002","ConnectionId":"0HNJBSAT920OM"}
[2026-02-14 10:23:11 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 10:23:12 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 10:23:13 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 10:23:13 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 10:23:21 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBSLFDBKCB:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:23:21 INF] HTTP GET /api/v1/health responded 200 in 210.2393 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCB:00000001","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:23:36 ERR] Failed executing DbCommand (77ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCB:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:23:36 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCB:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:23:36 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCB:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:23:37 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 1369.1240 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCB:00000002","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:23:45 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"19bd8b54-c59f-49c5-b792-992f37038130","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBSLFDBKCB:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:23:45 INF] HTTP POST /api/v1/auth/login responded 200 in 1249.5399 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCB:00000003","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:24:02 ERR] Failed executing DbCommand (3ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCB:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:24:02 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCB:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:24:02 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCB:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCB"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_email"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_email"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_email
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:24:02 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 314.6623 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCB:00000004","ConnectionId":"0HNJBSLFDBKCB"}
[2026-02-14 10:26:00 ERR] Failed executing DbCommand (6ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:00 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:26:00 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCD:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:26:00 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 177.1559 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCD:00000001","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:21 ERR] Failed executing DbCommand (2ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:21 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:26:21 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCD:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:26:21 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 178.6098 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCD:00000002","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:32 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"19bd8b54-c59f-49c5-b792-992f37038130","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:32 INF] HTTP POST /api/v1/auth/login responded 200 in 150.9966 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCD:00000003","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:53 ERR] Failed executing DbCommand (4ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:26:53 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCD:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:26:53 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCD:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCD"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "ix_users_username"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "ix_users_username"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: users
    ConstraintName: ix_users_username
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:26:53 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 195.2263 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCD:00000004","ConnectionId":"0HNJBSLFDBKCD"}
[2026-02-14 10:28:53 ERR] Failed executing DbCommand (15ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCF:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCF"}
[2026-02-14 10:28:53 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCF:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCF"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:28:53 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCF:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCF"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:28:53 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 240.7747 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCF:00000001","ConnectionId":"0HNJBSLFDBKCF"}
[2026-02-14 10:33:01 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"19bd8b54-c59f-49c5-b792-992f37038130","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBSLFDBKCH:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBSLFDBKCH"}
[2026-02-14 10:33:01 INF] HTTP POST /api/v1/auth/login responded 200 in 424.5177 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCH:00000001","ConnectionId":"0HNJBSLFDBKCH"}
[2026-02-14 10:35:23 ERR] Failed executing DbCommand (20ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Boolean), @p12='?' (DbType = Decimal), @p13='?' (DbType = Boolean), @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = DateTime), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id_user, created_at, dpi, direction, email, ingresos_mensuales, name, name_work, no_cuenta, password_hash, phone, requiere_cambio_pass, saldo_actual, status, surname, updated_at, username)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
INSERT INTO user_emails (id_email, email_verification_token, email_verification_token_expiry, id_user)
VALUES (@p17, @p18, @p19, @p20)
RETURNING email_verified; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCJ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCJ"}
[2026-02-14 10:35:23 ERR] An exception occurred in the database while saving changes for context type 'AuthService.Persistence.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"0c583367-3d3b-4b9c-ac4a-90956d46542f","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBSLFDBKCJ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCJ"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-14 10:35:23 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBSLFDBKCJ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBSLFDBKCJ"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "pk_user_emails"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "pk_user_emails"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: user_emails
    ConstraintName: pk_user_emails
    File: nbtinsert.c
    Line: 649
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at AuthService.Persistence.Repositories.UserRepository.CreateAsync(User user) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Persistence\Repositories\UserRepository.cs:line 71
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 144
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 74
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 10:35:24 ERR] HTTP POST /api/v1/auth/admin/create-user responded 500 in 439.7035 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBSLFDBKCJ:00000001","ConnectionId":"0HNJBSLFDBKCJ"}
[2026-02-14 11:40:55 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 11:40:56 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 11:40:56 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 11:40:57 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 11:41:07 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBU0TVBI6I:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJBU0TVBI6I"}
[2026-02-14 11:41:07 INF] HTTP GET /api/v1/health responded 200 in 178.2588 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU0TVBI6I:00000001","ConnectionId":"0HNJBU0TVBI6I"}
[2026-02-14 11:41:13 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"04f4de62-b725-4fd3-a20b-af8061aeb22d","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBU0TVBI6I:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU0TVBI6I"}
[2026-02-14 11:41:13 INF] HTTP POST /api/v1/auth/login responded 200 in 962.1819 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU0TVBI6I:00000002","ConnectionId":"0HNJBU0TVBI6I"}
[2026-02-14 11:42:15 INF] User chity registered successfully {"EventId":{"Id":1001,"Name":"LogUserRegistered"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"392b03bf-0784-4c3e-aafe-ec2076deefd0","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU0TVBI6K:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:42:15 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 1213.0955 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU0TVBI6K:00000001","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:42:20 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"392b03bf-0784-4c3e-aafe-ec2076deefd0","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU0TVBI6K:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:42:20 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"392b03bf-0784-4c3e-aafe-ec2076deefd0","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU0TVBI6K:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:42:20 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"392b03bf-0784-4c3e-aafe-ec2076deefd0","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU0TVBI6K:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:42:20 INF] Email de verificación enviado {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"392b03bf-0784-4c3e-aafe-ec2076deefd0","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU0TVBI6K:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU0TVBI6K"}
[2026-02-14 11:44:38 WRN] Failed login attempt {"EventId":{"Id":1003,"Name":"LogFailedLoginAttempt"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"04f4de62-b725-4fd3-a20b-af8061aeb22d","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBU0TVBI6M:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU0TVBI6M"}
[2026-02-14 11:44:38 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBU0TVBI6M:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU0TVBI6M"}
System.UnauthorizedAccessException: La cuenta de usuario está deshabilitada
   at AuthService.Application.Services.AuthService.LoginAsync(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 160
   at AuthService.Api.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 84
   at lambda_method21(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 11:44:38 INF] HTTP POST /api/v1/auth/login responded 401 in 313.8042 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU0TVBI6M:00000001","ConnectionId":"0HNJBU0TVBI6M"}
[2026-02-14 11:45:17 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 11:45:17 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 11:45:18 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 11:45:18 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 11:46:19 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:22 INF] User chity registered successfully {"EventId":{"Id":1001,"Name":"LogUserRegistered"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:22 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 2199.4615 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCE:00000001","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:25 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:25 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:25 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:46:25 INF] Email de verificación enviado {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCE:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCE"}
[2026-02-14 11:49:47 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"924f005f-ba01-4d1b-8bdf-d144b6d5d2e9","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBU3R05MCG:00000001","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:49:47 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"924f005f-ba01-4d1b-8bdf-d144b6d5d2e9","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBU3R05MCG:00000001","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:49:47 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"924f005f-ba01-4d1b-8bdf-d144b6d5d2e9","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBU3R05MCG:00000001","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:49:47 INF] Email verified successfully for user chity {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"924f005f-ba01-4d1b-8bdf-d144b6d5d2e9","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBU3R05MCG:00000001","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:49:47 INF] HTTP POST /api/v1/auth/verify-email responded 200 in 4576.2987 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCG:00000001","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:49:56 INF] HTTP POST /api/v1/auth/login responded 200 in 477.5060 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCG:00000002","ConnectionId":"0HNJBU3R05MCG"}
[2026-02-14 11:52:25 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f6121c37-2bb4-4967-8eed-8dcad5892a17","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBU3R05MCI:00000001","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBU3R05MCI"}
[2026-02-14 11:52:25 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f6121c37-2bb4-4967-8eed-8dcad5892a17","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBU3R05MCI:00000001","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBU3R05MCI"}
[2026-02-14 11:52:25 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f6121c37-2bb4-4967-8eed-8dcad5892a17","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBU3R05MCI:00000001","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBU3R05MCI"}
[2026-02-14 11:52:25 INF] Password reset email sent to egomez-2021272@kinal.edu.gt {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f6121c37-2bb4-4967-8eed-8dcad5892a17","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBU3R05MCI:00000001","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBU3R05MCI"}
[2026-02-14 11:52:25 INF] HTTP POST /api/v1/auth/forgot-password responded 200 in 2448.0889 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCI:00000001","ConnectionId":"0HNJBU3R05MCI"}
[2026-02-14 11:56:22 INF] Password reset successfully for user chity {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"2144f45a-6e22-44bc-bc50-a4aacfb15690","ActionName":"AuthService.Api.Controllers.AuthController.ResetPassword (AuthService.Api)","RequestId":"0HNJBU3R05MCK:00000001","RequestPath":"/api/v1/auth/reset-password","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 11:56:22 INF] HTTP POST /api/v1/auth/reset-password responded 200 in 688.8984 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCK:00000001","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 11:56:47 WRN] Failed login attempt {"EventId":{"Id":1003,"Name":"LogFailedLoginAttempt"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"7d7b2f25-2fc9-4e66-9917-9c47e3e612af","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBU3R05MCK:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 11:56:47 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJBU3R05MCK:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU3R05MCK"}
System.UnauthorizedAccessException: Credenciales inválidas
   at AuthService.Application.Services.AuthService.LoginAsync(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 167
   at AuthService.Api.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 84
   at lambda_method617(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 11:56:47 INF] HTTP POST /api/v1/auth/login responded 401 in 248.1961 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCK:00000002","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 11:56:57 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"7d7b2f25-2fc9-4e66-9917-9c47e3e612af","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBU3R05MCK:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 11:56:57 INF] HTTP POST /api/v1/auth/login responded 200 in 168.4118 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCK:00000003","ConnectionId":"0HNJBU3R05MCK"}
[2026-02-14 12:18:51 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 419.9700 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCM:00000001","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:11 INF] User jperez registered successfully {"EventId":{"Id":1001,"Name":"LogUserRegistered"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:11 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 375.3067 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBU3R05MCM:00000002","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:13 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:13 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:13 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:19:13 INF] Email de verificación enviado {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f4a92b57-f943-49b5-a2cb-e53f1ba2ed5e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBU3R05MCM:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBU3R05MCM"}
[2026-02-14 12:29:50 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 12:29:52 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 12:29:52 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 12:29:52 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 12:30:35 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJBUSIIVCI5:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:30:37 INF] jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f5baa52c-c3b9-435f-a539-acbef69b7d72","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:30:38 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f5baa52c-c3b9-435f-a539-acbef69b7d72","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:30:39 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f5baa52c-c3b9-435f-a539-acbef69b7d72","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:30:39 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f5baa52c-c3b9-435f-a539-acbef69b7d72","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:30:39 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 3182.1586 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000001","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:21 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"04729f1b-d987-4168-a074-0519b5294549","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:22 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"04729f1b-d987-4168-a074-0519b5294549","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:22 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"04729f1b-d987-4168-a074-0519b5294549","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:22 INF] Email verified successfully for user jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"04729f1b-d987-4168-a074-0519b5294549","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:22 INF] HTTP POST /api/v1/auth/verify-email responded 200 in 2559.2629 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000002","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:31:59 INF] HTTP POST /api/v1/auth/login responded 200 in 531.6693 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000003","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:32:35 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"08a4318a-814e-4b9c-81cb-031dca435981","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:32:35 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"08a4318a-814e-4b9c-81cb-031dca435981","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:32:35 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"08a4318a-814e-4b9c-81cb-031dca435981","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:32:35 INF] Password reset email sent to estuardogomez6b@gmail.com {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"08a4318a-814e-4b9c-81cb-031dca435981","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:32:35 INF] HTTP POST /api/v1/auth/forgot-password responded 200 in 1428.5181 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000004","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:33:16 INF] Password reset successfully for user jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"dca790b2-8e82-4b9b-87eb-85bf16935b12","ActionName":"AuthService.Api.Controllers.AuthController.ResetPassword (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000005","RequestPath":"/api/v1/auth/reset-password","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:33:16 INF] HTTP POST /api/v1/auth/reset-password responded 200 in 469.6256 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000005","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:34:06 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"b7261ed4-ef41-4ca7-8089-dbb16bed3105","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBUSIIVCI5:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 12:34:06 INF] HTTP POST /api/v1/auth/login responded 200 in 241.5395 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI5:00000006","ConnectionId":"0HNJBUSIIVCI5"}
[2026-02-14 13:05:11 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"b7261ed4-ef41-4ca7-8089-dbb16bed3105","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBUSIIVCI7:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBUSIIVCI7"}
[2026-02-14 13:05:11 INF] HTTP POST /api/v1/auth/login responded 200 in 456.5101 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI7:00000001","ConnectionId":"0HNJBUSIIVCI7"}
[2026-02-14 13:05:20 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"b7261ed4-ef41-4ca7-8089-dbb16bed3105","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJBUSIIVCI7:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJBUSIIVCI7"}
[2026-02-14 13:05:20 INF] HTTP POST /api/v1/auth/login responded 200 in 132.8901 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJBUSIIVCI7:00000002","ConnectionId":"0HNJBUSIIVCI7"}
[2026-02-14 14:54:42 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 14:54:43 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 14:54:43 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 14:54:43 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:10:06 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 15:10:07 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 15:10:08 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 15:10:08 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:34:18 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 15:34:19 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 15:34:20 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 15:34:20 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:36:31 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJC24F204T3:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC24F204T3"}
[2026-02-14 15:36:34 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"3bb142f2-d998-481c-be5d-68c53054766a","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC24F204T3:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC24F204T3"}
[2026-02-14 15:36:34 INF] HTTP POST /api/v1/auth/login responded 200 in 3109.5984 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC24F204T3:00000001","ConnectionId":"0HNJC24F204T3"}
[2026-02-14 15:43:21 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 15:43:23 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 15:43:24 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 15:43:24 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:45:30 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 15:45:31 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 15:45:32 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 15:45:32 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:49:48 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 15:49:49 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 15:49:50 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 15:49:50 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 15:52:29 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJC2DCE7J9C:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 15:52:31 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"bc9ffe4f-a122-411f-84b2-eb8af4ddd215","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC2DCE7J9C:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 15:52:32 INF] HTTP POST /api/v1/auth/login responded 200 in 3051.6157 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9C:00000001","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 15:53:20 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"bc9ffe4f-a122-411f-84b2-eb8af4ddd215","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC2DCE7J9C:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 15:53:21 INF] HTTP POST /api/v1/auth/login responded 200 in 1724.7018 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9C:00000002","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 15:54:13 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC2DCE7J9C:00000003","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2DCE7J9C"}
AuthService.Application.Exceptions.BusinessException: Un usuario no tiene permisos para asignar roles
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 30
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method486(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 15:54:14 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 1311.6258 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9C:00000003","ConnectionId":"0HNJC2DCE7J9C"}
[2026-02-14 16:15:42 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC2DCE7J9E:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2DCE7J9E"}
AuthService.Application.Exceptions.BusinessException: Un usuario no tiene permisos para asignar roles
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 30
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method486(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:15:42 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 443.4596 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9E:00000001","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:16:07 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"bc9ffe4f-a122-411f-84b2-eb8af4ddd215","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC2DCE7J9E:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:16:08 INF] HTTP POST /api/v1/auth/login responded 200 in 788.7335 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9E:00000002","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:16:11 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"bc9ffe4f-a122-411f-84b2-eb8af4ddd215","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC2DCE7J9E:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:16:11 INF] HTTP POST /api/v1/auth/login responded 200 in 292.5936 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9E:00000003","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:16:50 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC2DCE7J9E:00000004","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2DCE7J9E"}
AuthService.Application.Exceptions.BusinessException: Un usuario no tiene permisos para asignar roles
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 30
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method486(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:16:50 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 239.7221 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2DCE7J9E:00000004","ConnectionId":"0HNJC2DCE7J9E"}
[2026-02-14 16:19:46 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 16:19:49 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 16:19:50 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 16:19:50 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 16:20:33 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJC2T2COTCE:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:20:35 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"9e657e4a-f70b-41b7-8d81-daf494d1983a","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC2T2COTCE:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:20:36 INF] HTTP POST /api/v1/auth/login responded 200 in 2893.3584 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2T2COTCE:00000001","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:21:10 INF] jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"006dd813-aa7f-4d90-b55c-46113768f26e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC2T2COTCE:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:21:14 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"006dd813-aa7f-4d90-b55c-46113768f26e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC2T2COTCE:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:21:14 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"006dd813-aa7f-4d90-b55c-46113768f26e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC2T2COTCE:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:21:14 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"006dd813-aa7f-4d90-b55c-46113768f26e","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC2T2COTCE:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:21:14 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 5592.7904 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC2T2COTCE:00000002","ConnectionId":"0HNJC2T2COTCE"}
[2026-02-14 16:26:14 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 16:26:16 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 16:26:17 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 16:26:17 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 16:26:50 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJC30IVPIRQ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:26:54 INF] jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f15057f6-6535-413d-8906-b530ebaa13c7","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC30IVPIRQ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:26:58 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f15057f6-6535-413d-8906-b530ebaa13c7","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC30IVPIRQ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:26:58 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f15057f6-6535-413d-8906-b530ebaa13c7","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC30IVPIRQ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:26:58 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"f15057f6-6535-413d-8906-b530ebaa13c7","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC30IVPIRQ:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:26:58 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 7347.7947 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRQ:00000001","ConnectionId":"0HNJC30IVPIRQ"}
[2026-02-14 16:31:46 WRN] Failed login attempt {"EventId":{"Id":1003,"Name":"LogFailedLoginAttempt"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f6632670-f023-4a0d-a935-8b6a984d9ad2","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:31:46 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC30IVPIRS:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC30IVPIRS"}
System.UnauthorizedAccessException: La cuenta de usuario está deshabilitada
   at AuthService.Application.Services.AuthService.LoginAsync(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 150
   at AuthService.Api.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 86
   at lambda_method533(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:31:46 INF] HTTP POST /api/v1/auth/login responded 401 in 2378.1341 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRS:00000001","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:26 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"e203d2c8-baae-44bf-9208-49f8613070e4","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:26 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"e203d2c8-baae-44bf-9208-49f8613070e4","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:26 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"e203d2c8-baae-44bf-9208-49f8613070e4","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:26 INF] Email verified successfully for user jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"e203d2c8-baae-44bf-9208-49f8613070e4","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000002","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:26 INF] HTTP POST /api/v1/auth/verify-email responded 200 in 3825.8984 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRS:00000002","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:35 INF] HTTP POST /api/v1/auth/login responded 200 in 601.6745 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRS:00000003","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:54 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"d3ac30ef-20e9-43a7-a8d9-365d957b70d5","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:54 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"d3ac30ef-20e9-43a7-a8d9-365d957b70d5","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:54 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"d3ac30ef-20e9-43a7-a8d9-365d957b70d5","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:54 INF] Password reset email sent to estuardogomez6b@gmail.com {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"d3ac30ef-20e9-43a7-a8d9-365d957b70d5","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC30IVPIRS:00000004","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:32:54 INF] HTTP POST /api/v1/auth/forgot-password responded 200 in 2618.2673 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRS:00000004","ConnectionId":"0HNJC30IVPIRS"}
[2026-02-14 16:34:58 INF] Password reset successfully for user jperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"21a1ce06-fb40-4595-be7e-970831562259","ActionName":"AuthService.Api.Controllers.AuthController.ResetPassword (AuthService.Api)","RequestId":"0HNJC30IVPIRU:00000001","RequestPath":"/api/v1/auth/reset-password","ConnectionId":"0HNJC30IVPIRU"}
[2026-02-14 16:34:58 INF] HTTP POST /api/v1/auth/reset-password responded 200 in 1239.1146 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRU:00000001","ConnectionId":"0HNJC30IVPIRU"}
[2026-02-14 16:35:31 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f6632670-f023-4a0d-a935-8b6a984d9ad2","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC30IVPIRU:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC30IVPIRU"}
[2026-02-14 16:35:31 INF] HTTP POST /api/v1/auth/login responded 200 in 370.6655 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIRU:00000002","ConnectionId":"0HNJC30IVPIRU"}
[2026-02-14 16:36:53 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC30IVPIS0:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIS0"}
AuthService.Application.Exceptions.BusinessException: Un admin no puede crear otro admin, únicamente usuarios
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 35
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method27(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:36:53 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 509.6715 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIS0:00000001","ConnectionId":"0HNJC30IVPIS0"}
[2026-02-14 16:40:28 WRN] Registration rejected: email already exists {"EventId":{"Id":1004,"Name":"LogRegistrationWithExistingEmail"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"f15057f6-6535-413d-8906-b530ebaa13c7","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC30IVPIS2:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIS2"}
[2026-02-14 16:40:28 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC30IVPIS2:00000001","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIS2"}
AuthService.Application.Exceptions.BusinessException: El email ya existe
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 43
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method27(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:40:28 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 335.0019 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIS2:00000001","ConnectionId":"0HNJC30IVPIS2"}
[2026-02-14 16:40:42 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC30IVPIS2:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC30IVPIS2"}
System.InvalidOperationException: Rol por defecto 'Admin' no encontrado. Asegúrese de que la siembra se ejecute antes del registro
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 66
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method27(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 16:40:42 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 56.2241 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC30IVPIS2:00000002","ConnectionId":"0HNJC30IVPIS2"}
[2026-02-14 17:30:44 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 17:30:45 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 17:30:46 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 17:30:46 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 17:39:01 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJC48TGQDV4:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:02 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"01c1c188-94ae-48c4-b9c5-89bc099a1b0b","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:02 INF] HTTP POST /api/v1/auth/login responded 200 in 1657.5271 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000001","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:48 INF] eperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"5baba764-ea4f-4e93-99f3-bc2b0dd0e7f9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:51 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"5baba764-ea4f-4e93-99f3-bc2b0dd0e7f9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:51 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"5baba764-ea4f-4e93-99f3-bc2b0dd0e7f9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:51 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"5baba764-ea4f-4e93-99f3-bc2b0dd0e7f9","ActionName":"AuthService.Api.Controllers.AuthController.CreateUserByAdmin (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000002","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:39:51 INF] HTTP POST /api/v1/auth/admin/create-user responded 201 in 4054.9743 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000002","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:31 WRN] Failed login attempt {"EventId":{"Id":1003,"Name":"LogFailedLoginAttempt"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"01c1c188-94ae-48c4-b9c5-89bc099a1b0b","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:31 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC48TGQDV4:00000003","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC48TGQDV4"}
System.UnauthorizedAccessException: La cuenta de usuario está deshabilitada
   at AuthService.Application.Services.AuthService.LoginAsync(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 150
   at AuthService.Api.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 86
   at lambda_method27(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 17:40:31 INF] HTTP POST /api/v1/auth/login responded 401 in 89.3382 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000003","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:51 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"b5b9036d-b836-4660-a710-f760c02f4ea3","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000004","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:51 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"b5b9036d-b836-4660-a710-f760c02f4ea3","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000004","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:51 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"b5b9036d-b836-4660-a710-f760c02f4ea3","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000004","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:51 INF] Email verified successfully for user eperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"b5b9036d-b836-4660-a710-f760c02f4ea3","ActionName":"AuthService.Api.Controllers.AuthController.VerifyEmail (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000004","RequestPath":"/api/v1/auth/verify-email","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:40:51 INF] HTTP POST /api/v1/auth/verify-email responded 200 in 3287.6432 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000004","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:20 INF] HTTP POST /api/v1/auth/login responded 200 in 287.3485 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000005","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:37 INF] Email enviado exitosamente {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"abc8d264-85bb-4e8b-b058-05d0f1a11968","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000006","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:37 INF] Pipeline de email completado {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"abc8d264-85bb-4e8b-b058-05d0f1a11968","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000006","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:37 INF] Email processed {"SourceContext":"AuthService.Application.Services.EmailService","ActionId":"abc8d264-85bb-4e8b-b058-05d0f1a11968","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000006","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:37 INF] Password reset email sent to estuardogomez6b@gmail.com {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"abc8d264-85bb-4e8b-b058-05d0f1a11968","ActionName":"AuthService.Api.Controllers.AuthController.ForgotPassword (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000006","RequestPath":"/api/v1/auth/forgot-password","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:41:37 INF] HTTP POST /api/v1/auth/forgot-password responded 200 in 3344.9607 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000006","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:01 INF] HTTP POST /api/v1/auth/reset-password responded 200 in 62.8109 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000007","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:22 INF] Password reset successfully for user eperez {"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"91c9f225-c1fc-4af7-8588-9d068d497896","ActionName":"AuthService.Api.Controllers.AuthController.ResetPassword (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000008","RequestPath":"/api/v1/auth/reset-password","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:22 INF] HTTP POST /api/v1/auth/reset-password responded 200 in 136.4543 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000008","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:33 INF] User login succeeded {"EventId":{"Id":1002,"Name":"LogUserLoggedIn"},"SourceContext":"AuthService.Application.Services.AuthService","ActionId":"01c1c188-94ae-48c4-b9c5-89bc099a1b0b","ActionName":"AuthService.Api.Controllers.AuthController.Login (AuthService.Api)","RequestId":"0HNJC48TGQDV4:00000009","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:33 INF] HTTP POST /api/v1/auth/login responded 200 in 234.3237 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:00000009","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 17:42:59 ERR] An unhandled exception occurred {"SourceContext":"AuthService.Api.Middlewares.GlobalExceptionMiddleware","RequestId":"0HNJC48TGQDV4:0000000A","RequestPath":"/api/v1/auth/admin/create-user","ConnectionId":"0HNJC48TGQDV4"}
AuthService.Application.Exceptions.BusinessException: Un admin no puede crear otro admin, únicamente usuarios
   at AuthService.Application.Services.AuthService.CreateUserByAdminAsync(AdminCreateUserDto dto, String currentUserRole) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Application\Services\AuthService.cs:line 35
   at AuthService.Api.Controllers.AuthController.CreateUserByAdmin(AdminCreateUserDto dto) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Controllers\AuthController.cs:line 76
   at lambda_method318(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at AuthService.Api.Middlewares.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\Users\rgome\Documents\IN6AM\ChapinBank\AuthenticationService\AuthService\src\AuthService.Api\Middlewares\GlobalExceptionMiddleware.cs:line 18
[2026-02-14 17:42:59 INF] HTTP POST /api/v1/auth/admin/create-user responded 400 in 109.6232 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJC48TGQDV4:0000000A","ConnectionId":"0HNJC48TGQDV4"}
[2026-02-14 23:18:10 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 23:18:12 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 23:18:12 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 23:18:12 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 23:19:40 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJCA78O18DS:00000001","RequestPath":"/api/v1/health","ConnectionId":"0HNJCA78O18DS"}
[2026-02-14 23:19:40 INF] HTTP GET /api/v1/health responded 200 in 500.1230 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJCA78O18DS:00000001","ConnectionId":"0HNJCA78O18DS"}
[2026-02-14 23:19:53 INF] HTTP GET /api/v1auth/profile responded 404 in 3.8074 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJCA78O18DS:00000002","ConnectionId":"0HNJCA78O18DS"}
[2026-02-14 23:20:27 INF] HTTP GET /api/v1/auth/profile responded 401 in 21.4102 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJCA78O18DS:00000003","ConnectionId":"0HNJCA78O18DS"}
[2026-02-14 23:30:50 INF] Verificando conexión a la base de datos... {"SourceContext":"Program"}
[2026-02-14 23:30:53 INF] Base de datos lista. Ejecutando datos semilla... {"SourceContext":"Program"}
[2026-02-14 23:30:54 INF] Inicialización de base de datos completada exitosamente {"SourceContext":"Program"}
[2026-02-14 23:30:54 INF] El API de AuthService está ejecutándose en http://localhost:5079. Endpoint de salud: http://localhost:5079/api/v1/health {"SourceContext":"Program"}
[2026-02-14 23:31:57 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJCAE4J8KGF:00000001","RequestPath":"/api/v1/auth/profile/by-id","ConnectionId":"0HNJCAE4J8KGF"}
[2026-02-14 23:31:57 INF] HTTP GET /api/v1/auth/profile/by-id responded 405 in 184.0104 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJCAE4J8KGF:00000001","ConnectionId":"0HNJCAE4J8KGF"}
[2026-02-14 23:32:31 INF] HTTP GET /api/v1/auth/profile responded 401 in 35.1086 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJCAE4J8KGF:00000002","ConnectionId":"0HNJCAE4J8KGF"}
